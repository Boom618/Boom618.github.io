<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>BoomHe</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ExceptionReadme总结项目中出现的异常java.util.ConcurrentModificationException 异常描述：该异常表示并发修改异常.迭代器迭代过程中，迭代的对象发生了改变，如数据项增加或删除. 解决思路：由于迭代对象不是线程安全，在迭代的过程中，会检查 modCount 是否和初始 modCount 即 expectedModCount 一致，如果不一致，则认为">
<meta property="og:type" content="article">
<meta property="og:title" content="BoomHe">
<meta property="og:url" content="http://yoursite.com/2017/07/21/项目异常/index.html">
<meta property="og:site_name" content="BoomHe">
<meta property="og:description" content="ExceptionReadme总结项目中出现的异常java.util.ConcurrentModificationException 异常描述：该异常表示并发修改异常.迭代器迭代过程中，迭代的对象发生了改变，如数据项增加或删除. 解决思路：由于迭代对象不是线程安全，在迭代的过程中，会检查 modCount 是否和初始 modCount 即 expectedModCount 一致，如果不一致，则认为">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-07-21T08:01:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BoomHe">
<meta name="twitter:description" content="ExceptionReadme总结项目中出现的异常java.util.ConcurrentModificationException 异常描述：该异常表示并发修改异常.迭代器迭代过程中，迭代的对象发生了改变，如数据项增加或删除. 解决思路：由于迭代对象不是线程安全，在迭代的过程中，会检查 modCount 是否和初始 modCount 即 expectedModCount 一致，如果不一致，则认为">
  
    <link rel="alternative" href="/atom.xml" title="BoomHe" type="application/atom+xml">
  
  
    <link rel="icon" href="https://avatars2.githubusercontent.com/u/10544851">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars2.githubusercontent.com/u/10544851" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">BoomHe</a></h1>
		</hgroup>

		
		<p class="header-subtitle">叫太阳起床的男人</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">BoomHe</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars2.githubusercontent.com/u/10544851" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">BoomHe</h1>
			</hgroup>
			
			<p class="header-subtitle">叫太阳起床的男人</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-项目异常" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/07/21/项目异常/" class="article-date">
  	<time datetime="2017-07-21T02:58:36.000Z" itemprop="datePublished">2017-07-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ExceptionReadme"><a href="#ExceptionReadme" class="headerlink" title="ExceptionReadme"></a>ExceptionReadme</h1><h3 id="总结项目中出现的异常"><a href="#总结项目中出现的异常" class="headerlink" title="总结项目中出现的异常"></a>总结项目中出现的异常</h3><h2 id="java-util-ConcurrentModificationException"><a href="#java-util-ConcurrentModificationException" class="headerlink" title="java.util.ConcurrentModificationException"></a>java.util.ConcurrentModificationException</h2><blockquote>
<p><strong>异常描述</strong>：该异常表示并发修改异常.迭代器迭代过程中，迭代的对象发生了改变，如数据项增加或删除.</p>
<p><strong>解决思路</strong>：由于迭代对象不是线程安全，在迭代的过程中，会检查 modCount 是否和初始 modCount 即 expectedModCount 一致，如果不一致，则认为数据有变化，迭代终止并抛出异常。常出现的场景是，两个线程同时对集合进行操作，线程 1 对集合进行遍历，而线程 2 对集合进行增加、删除操作，此时将会发生 ConcurrentModificationException 异常。</p>
<p><strong>解决方法</strong>：多线程访问时要增加同步锁，或者建议使用线程安全的集合：</p>
<ol>
<li>使用 ConcurrentHashMap 替换 HashMap，CopyOnWriteArrayList 替换 ArrayList。</li>
<li>或者使用使用 Vector 替换 ArrayList，Vector 是线程安全的。Vector 的缺点：大量数据操作时，由于线程安全，性能比 ArrayList低。</li>
</ol>
</blockquote>
<h2 id="java-lang-ArrayIndexOutOfBoundsException"><a href="#java-lang-ArrayIndexOutOfBoundsException" class="headerlink" title="java.lang.ArrayIndexOutOfBoundsException"></a>java.lang.ArrayIndexOutOfBoundsException</h2><blockquote>
<p><strong>异常描述</strong>：该异常表示数组越界.</p>
<p><strong>解决思路</strong>：这种情况一般要在数组循环前做好 length 判断，index 超出 length 上限和下限时都会报错。举例如下：一个数组 int test[N]，一共有 N 个元素分别是test[0]~test[N-1]，如果调用 test[N]，将会报错。建议读取时，不要超过数组的长度（array.length）。<br>Android 中一种常见情形就是上拉刷新中 header 也会作为 listview 的第 0 个位置，如果判断失误很容易造成越界。</p>
<p><strong>异常情况</strong>：TextView 中 ellipsize 使用引发 Crash，该问题为 Android 系统 bug，存在于 Android 5.0 及以下设备，<a href="https://code.google.com/p/android/issues/detail?id=33868" target="_blank" rel="external">问题描述参考</a></p>
<p><strong>解决方法</strong>：使用 android:singleLine=”true” 代替 android:lines=”1” 和 android:maxLines=”1”</p>
</blockquote>
<h2 id="java-lang-IllegalStateException"><a href="#java-lang-IllegalStateException" class="headerlink" title="java.lang.IllegalStateException"></a>java.lang.IllegalStateException</h2><blockquote>
<p><strong>异常描述</strong>：状态异常</p>
<p><strong>解决思路</strong> 错误类型大致为以下几种:</p>
<ul>
<li>java.lang.IllegalStateException：Cannot forward a response that is   already committed(无法转发已经提交的响应)</li>
<li>IllegalStateException：response already commited(响应已经提交)</li>
<li>IllegalStateException：getOutputStream() has already been called for this request(已经为此请求调用了getOutputStream )<br>……………</li>
</ul>
<p>例1：IllegalStateException: Can not perform this action after onSaveInstanceState(在onSaveInstanceState之后无法执行此操作)</p>
<p><strong>错误原因</strong>：<br>该异常表示，当前对客户端的响应已经结束，不能在响应已经结束（或说消亡）后再向客户端（实际上是缓冲区）输出任何内容。Object is no longer valid to operate on. Was it deleted by another thread? 该异常表示，realmObject 对象在其他线程已被删除，在这个线程中使用的时候抛出的异常。</p>
<p><strong>解决方法</strong>：<br>onSaveInstanceState 方法是在该 Activity 即将被销毁前调用，来保存 Activity 数据的，如果在保存玩状态后再给它添加 Fragment 就会出错。解决办法就是把 commit（）方法替换成 commitAllowingStateLoss()</p>
<p><strong>具体分析</strong>：<br>首先解释下flush()，我们知道在使用读写流的时候数据先被读入内存这个缓冲区中， 然后再写入文件，但是当数据读完时不代表数据已经写入文件完毕，因为可能还有一部分仍未写入文件而留在内存中，这时调用 flush() 方法就会把缓冲区的数据强行清空输出，因此 flush() 的作用就是保证缓存清空输出。response 是服务端对客户端请求的一个响应，其中封装了响应头、状态码、内容等，服务端在把 response 提交到客户端之前，会向缓冲区内写入响应头和状态码，然后将所有内容 flush。这就标志着该次响应已经 committed。对于当前页面中已经 committed 的 response，就不能再使用这个 response 向缓冲区写任何东西（注：同一个页面中的 response.XXX()是同一个 response 的不同方法，只要其中一个已经导致了 committed，那么其它类似方式的调用都会导致 IllegalStateException 异常）。<br><a href="http://my.oschina.net/guhai2004/blog/187041" target="_blank" rel="external">参考1</a>、<a href="https://github.com/realm/realm-java/issues/1206" target="_blank" rel="external">参考2</a></p>
<p>例2: java.lang.IllegalStateException<br>Can’t change tag of fragment d{e183845 #0 d{e183845}}: was d{e183845} now d{e183845 #0 d{e183845}}</p>
<p><strong>错误原因</strong>：<br>经查，我在显示 fragment 的代码中使用了 fragment.show(getSupportFragmentManager, fragment.toString())<br>而这里是因为两次 toString()结果不同，导致不同的 tag 指向的是同一个 fragment。</p>
<p><strong>解决方法</strong>：<br>获取 fragment 的 tag 的正确方法应该是使用其提供的 fragment.getTag()方法。</p>
</blockquote>
<h2 id="java-lang-NullPointerException"><a href="#java-lang-NullPointerException" class="headerlink" title="java.lang.NullPointerException"></a>java.lang.NullPointerException</h2><blockquote>
<p><strong>异常描述</strong>：空指针</p>
<p><strong>解决思路</strong>：使用了一个空对象引用，建议您检查引用的对象是否为空</p>
<p><strong>解决方法</strong>：这种异常通常是调用一个对象的方法抛出的，凡是调用一个对象的方法之前，一定要进行判空或者进行try-catch，这样基本可以规避大部分空指针异常。</p>
</blockquote>
<h2 id="java-lang-IllegalArgumentException"><a href="#java-lang-IllegalArgumentException" class="headerlink" title="java.lang.IllegalArgumentException"></a>java.lang.IllegalArgumentException</h2><blockquote>
<p><strong>异常描述</strong>：参数不匹配异常，通常由于传递了不正确的参数导致。</p>
<p><strong>解决思路</strong>：检测传入的参数</p>
<p><strong>解决方法</strong>：常见于：</p>
<ul>
<li>Activity、Service 状态异常</li>
<li>非法URL</li>
<li>UI线程操作</li>
<li>Fragment中嵌套了子 Fragment，Fragment 被销毁，而内部 Fragment 未被销毁，所以导致再次加载时重复，在 onDestroyView() 中将内部 Fragment 销毁即可</li>
<li>在请求网络的回调中使用了glide.into(view),view 已经被销毁会导致该错误</li>
</ul>
</blockquote>
<h2 id="android-os-DeadObjectException"><a href="#android-os-DeadObjectException" class="headerlink" title="android.os.DeadObjectException"></a>android.os.DeadObjectException</h2><blockquote>
<p><strong>异常描述</strong>：死机异常</p>
<p><strong>解决思路</strong>：建议在服务终止或对象回收后把相应的引用置空，并且在所有可能用到这个对象的地方进行判空操作。该异常表示对应的服务或对象已经停止，但是却仍有对其发起调用。</p>
<p><strong>解决方法</strong>：</p>
<ul>
<li>数据库，蓝牙等用已调用过 close()的对象来 connect()，将会报错。</li>
<li>引用被系统回收的对象，也会报这个错误。</li>
</ul>
</blockquote>
<h2 id="java-util-concurrent-TimeoutException"><a href="#java-util-concurrent-TimeoutException" class="headerlink" title="java.util.concurrent.TimeoutException"></a>java.util.concurrent.TimeoutException</h2><blockquote>
<p><strong>异常描述</strong>：该异常表示调用超时。</p>
<p><strong>解决思路</strong>：一般是系统在 gc 时，调用对象的 finalize 超时导致，</p>
<p><strong>解决方法</strong>：</p>
<ul>
<li>检查分析 finalize 的实现为什么耗时较高，修复它。</li>
<li>检查日志查看 GC 是否过于频繁，导致超时，减少内容开销，防止内存泄露。</li>
</ul>
</blockquote>
<h2 id="java-lang-ClassNotFoundException"><a href="#java-lang-ClassNotFoundException" class="headerlink" title="java.lang.ClassNotFoundException"></a>java.lang.ClassNotFoundException</h2><blockquote>
<p><strong>异常描述</strong>：该异常表示在路径下，找不到指定类，通常是因为构建路径问题导致的。</p>
<p><strong>解决思路</strong>：</p>
<p><strong>解决方法</strong>：类名是以字符串形式标识的，可信度比较低，在调用Class.forName(“”),Class.findSystemClass(“”),Class.loadClass(“”)等方法时，找不到类名时将会报错。如果找不到的 Class 是系统 Class，那么可能是系统版本兼容，厂家 Rom 兼容的问题，找到对应的设备尝试重现，解决方法可以考虑更换Api，或用自己实现的 Class替代。如果找不到的 Class 是应用自由 Class（含第三方SDK的 Class），可以通过反编译工具查看对应 apk 中是否真的缺少该 Class，再进行定位，这种往往发生在：</p>
<ul>
<li>要找的 Class 被混淆了，存在但名字变了。</li>
<li>要找的 Class 未被打入 Dex，确实不存在，可能是因为自己的疏忽，或编译环境的冲突。</li>
<li>要找的 Class 确实存在，但你的 Classlorder 找不到这个 Class，往往因为这个 Classloder 是你自实现的（插件化应用中常见）。</li>
</ul>
</blockquote>
<h2 id="java-lang-SecurityException"><a href="#java-lang-SecurityException" class="headerlink" title="java.lang.SecurityException"></a>java.lang.SecurityException</h2><blockquote>
<p><strong>异常描述</strong>：权限异常</p>
<p><strong>解决思路</strong>：检查权限</p>
<p><strong>解决方法</strong>：权限异常或者称为安全异常，由安全管理器抛出，用于指示违反安全情况的异常，通常由于没有获取对应的权限。</p>
<ul>
<li>android 6.0 以下需要在 manifest 中声明相应的权限。</li>
<li>android 6.0 及以上，在使用时需要动态申请权限。</li>
</ul>
</blockquote>
<h2 id="java-lang-OutOfMemoryError"><a href="#java-lang-OutOfMemoryError" class="headerlink" title="java.lang.OutOfMemoryError"></a>java.lang.OutOfMemoryError</h2><blockquote>
<p><strong>异常描述</strong>：该异常表示未能成功分配字节内存，通常是因为内存不足导致的内存溢出。</p>
<p><strong>解决思路</strong>：</p>
<p><strong>解决方法</strong>：OOM 就是内存溢出，即 Out of Memory。也就是说内存占有量超过了 VM 所分配的最大。怎么解决 OOM，通常 OOM 都发生在需要用到大量内存的情况下（创建或解析 Bitmap，分配特大的数组等），这里列举常见避免 OOM 的几个注意点：</p>
<ul>
<li>适当调整图像大小。</li>
<li>采用合适的缓存策略。</li>
<li>采用低内存占用量的编码方式，比如 Bitmap.Config.ARGB_4444 比 Bitmap.Config.ARGB_8888 更省内存。</li>
<li>及时回收 Bitmap。</li>
<li>不要在循环中创建过多的本地变量。</li>
<li>自定义对内存分配大小。</li>
<li>特殊情况可在 mainfests 的 Application 中增加 android:largeHeap=”true” 属性，比如临时创建多个小图片(地图 marker )</li>
</ul>
</blockquote>
<h2 id="android-os-FileUriExposedException"><a href="#android-os-FileUriExposedException" class="headerlink" title="android.os.FileUriExposedException"></a>android.os.FileUriExposedException</h2><blockquote>
<p><strong>异常描述</strong>：文件 Uri 暴露异常</p>
<p><strong>解决思路</strong>：</p>
<ul>
<li>首先我们对 Android N及以上做判断.</li>
<li>然后添加 flags，表明我们要被授予什么样的临时权限.</li>
<li>BuildConfig.APPLICATION_ID 直接获取的是应用的包名.</li>
</ul>
<p><strong>解决方法</strong>：对于面向 Android N (7.x) 的应用，Android 框架执行的 StrictMode API 政策禁止向您的应用外公开 file://URI。 如果一项包含文件 URI 的 Intent 离开您的应用，应用失败，并出现 FileUriExposedException 异常。若要在应用间共享文件，您应发送一项 content://URI，并授予 URI 临时访问权限。 进行此授权的最简单方式是使用 FileProvider 类。<a href="http://www.cnblogs.com/yongdaimi/p/6067319.html" target="_blank" rel="external">参考</a></p>
</blockquote>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/07/21/排序算法/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2017/07/21/项目库/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"></div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="项目异常" data-title="" data-url="http://yoursite.com/2017/07/21/项目异常/"  data-images="https://avatars2.githubusercontent.com/u/10544851" data-content="">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 BoomHe
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>